<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head><meta http-equiv="content-type" content="text/html;charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style type="text/css">
img{max-width:100%}
body{background:#fafafa;color:#222;font-family:"Segoe UI",Helvetica,Arial,sans-serif;line-height:1.6;margin:auto;padding:2rem}
h2,strong{color:#111;margin-top:1em;padding-top:1em}
.content{margin:0 auto;max-width:40rem;text-align:justify}
.cl{border-style:solid;border-width:1px;text-align:center;width:100px}
.cl a{text-decoration:none}
.dl{border-style:solid;border-width:1px;text-align:center;width:50px}
table.sourceCode,tr.sourceCode,td.lineNumbers,td.sourceCode,table.sourceCode pre{border:0;border:none;margin:0;padding:0;vertical-align:baseline}
td.lineNumbers{border-right:1px solid #AAA;color:#AAA;padding-left:5px;padding-right:5px;text-align:right}
td.sourceCode{padding-left:5px}
.sourceCode span.kw{color:#007020;font-weight:700}
.sourceCode span.dt{color:#902000}
.sourceCode span.dv{color:#40a070}
.sourceCode span.bn{color:#40a070}
.sourceCode span.fl{color:#40a070}
.sourceCode span.ch{color:#4070a0}
.sourceCode span.st{color:#4070a0}
.sourceCode span.co{color:#60a0b0;font-style:italic}
.sourceCode span.ot{color:#007020}
.sourceCode span.al{color:red;font-weight:700}
.sourceCode span.fu{color:#06287e}
.sourceCode span.er{color:red;font-weight:700}
</style>
<title>Титульные экраны NES</title>
<link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAD1BMVEUAAABHcEwAAAAAAAAAAABxUQwvAAAABXRSTlP5ABxjsWDF1fcAAAC6SURBVHheXZHREYQgDET3xAaCFmDEApC7AhTpv6abIBIwX/DmTbKZgIgck5aAKb4AHeEF5pF7YGG4A+QRezADoQMWGLkCG5g2wHA1flewHtg1GHB9PT7aYwGQYBRM1wFpq1PYAcCuQKIBpgVLVipwqxgwXICVnlkpYCv/sRg2pRuYJ+kqyRGOmIGu69sp4m9cwZKASCtRO/aUVzvWOF3O3ymqYZFraE6ZlVMN9rIcP0AcdjDdXZj8cIM/F94kJn1XsxcAAAAASUVORK5CYII=" rel="icon" type="image/x-icon" />
</head><body>
<div style="position:absolute; top:0; left:0; width:100%">
<a href="../../"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASoAAAAiBAMAAAAaMInFAAAAD1BMVEUAAAAAAAAAAAAAAAAAAABPDueNAAAABHRSTlMAPsGB1Tj7uQAAAYlJREFUeF7tmFGugjAQRafFBQyBBfiIC9CUBYjO/tf05NI6WqsGEmo/OF8107keJsUmUprGOaaVWB7fixxpBnni67rm4qzAL61MHXhYYlZPFYwOlQDrkk1U+RIPK3x8k0dWAryTANq0Qq3InsiIXOggnoEkcK5Ero8VpfoU/9xlJLBfy2qz2qwuHeAdlgdtQ+XVqsMmWGGpVh34i6ymEB/fhfgKWzUPVh04ktVnu7WdiVq1QuXViomst0KXWjHFoEKoTfEU4mlC8xDvia2MFGPlRtCGUV3vVsa5hFXl+rSVA6e5Vg3yjIQAvj+1b8OojmqVOO3YmLTyDHOt2vi0x1bjhgvNsTL+xlnTaow+z7BS1rSygpgsVmHC362Qvc9ihdonK+fuVjZ6B0e8VaXv4I1TbNVgb7/AqkGecaAPVk9t+tuu+ZNVH6wIIP8Fu8CKHmmTVvadVSU5rfBl2maSt7Nn0NOz5FwBxIP07Tzfiku0GqhEKy7RaqASrTiblUYyFUZ+q80q/z9KG/9rSELgY1xnzQAAAABJRU5ErkJggg==" alt="logo" /></a>
<table style="float:right" cellspacing="3"><tbody><tr> 
 <td class="cl"> <a href="../../">NEWS</a> </td>
 <td class="cl"> <a href="../../doc">ARTiCLES</a> </td>
 <td class="cl"> <a href="../../passgen">PASSGENS</a> </td>
 <td class="cl"> <a href="../../archive.html">ARCHiVE</a> </td>
 <td class="cl"> <a href="../../about.html">ABOUT ME</a> </td>
 </tr></tbody></table></div>
<div class="content">
<h1>Титульные экраны NES</h1>
<p>Опыт подсказывает, что по теме перерисовки титульных экранов написано не так много документов. Большинство из них предлагает лишь базовые основы этого дела. Я расскажу, как это можно сделать быстрее и, возможно, более качественно.<br />
Основная проблема в перерисовке титульников связана с тем, что титульник, как и любая бэкграундовая графика в любой игре тесно связан с тайловыми картами. А особенностью тайловой карты титульника является большое число повторяющихся одинаковых данных (например, фон вокруг надписи). Для того чтобы держать такую карту в простейшем возможном (распакованном) виде нужно либо иметь ОЧЕНЬ много места в РОМе игры (не будем забывать, что карт может быть несклько десятков, а каждая будет размером 0х3С0), либо игра должна содержать только эту тайловую карту в явном виде (часто возникает ощущение, что разработчики добавляли карту впопыхах уже в процессе отладки =))<br />
В любом случае, такие явления довольно редки. А в подавляющем большинстве случаев карты пожаты простейшим RLE.<br />
Для неискушённых в программировании начинающих переводчиков возникает проблема: как в мессиве CHR ROM’а выделить тайлы, отвечающие за интересующую нас надпись, собрать их в нужном порядке, а потом вставить отредактированную графику назад (про редактирование тайловых карт в этом документе не будет сказано ни слова). Скажем, в документе InVerse ‘Title Screen Hacking Made Easy’ рекомендуется открыть VRAM viewer какого-нибудь эмулятора и на листочке выписывать номера тайлов, отвечающие за надпись и сопоставлять их с тайлами в графическом редакторе. Есть ещё вариант: самостоятельно копировать тайлы в отдельный пустой РОМ, а потом прибавлять к нему другие тайлы (это напоминает пазл). В конце концов, можно воспользоваться Tile Arranger’ом в Tile Layer Pro - это удобно с точки зрения обратной вставки.<br />
Все эти способы довольно трудоёмки и муторны. А между тем, всё необходимое для удобного редактирования титульника уже есть в видео памяти приставки! Во-первых, это загруженный нужный банк CHR ROM’a, в котором содержатся нужные нам тайлы. И во-вторых, полностью распакованная тайловая карта. Остаётся только всё это сдампить. Сделать это можно с помощью любимого всеми FCEUxd -&gt;Tools -&gt;Hex Editor -&gt;File -&gt;Dump to file -&gt;PPU Memory. Получаем всё содержимое видео памяти приставки в отдельный файл. В качестве редактора я могу порекомендовать любимый редактор тайловых карт (несмотря на то, что редактировать мы будем графику ^_^) Djinn Tile Mapper. Вместо РОМ’а открываем, естественно, наш дамп. Графика будет содержаться либо $0000-$0FFF, либо $1000-$1FFF. Для бэкграунда назначается одна область памяти, а для спрайтов - другая. Тайлы нужно смотреть в правом верхнем окне =) - не забудьте переключиться на нужный формат графики. А в окошке “Текст, код и прочий мусор” можно будет увидеть наш заветный титульник, точнее тайловую карту, обтянутую графикой.<br />
Можно найти и визуально, однако лучше будет искать по возможным адресам нахождения карты:</p>
<pre><code>Адрес 	Размер 	Название 
$2000 	$3C0 	Тайловая карта #0 
$23C0 	$40 	Таблица атрибутов #0 
$2400 	$3C0 	Тайловая карта #1 
$27C0 	$40 	Таблица атрибутов #1 
$2800 	$3C0 	Тайловая карта #2 
$2BC0 	$40 	Таблица атрибутов #2 
$2C00 	$3C0 	Тайловая карта #3 
$2FC0 	$40 	Таблица атрибутов #3</code></pre>
<p>Вот что должно примерно получиться:<br />
<img src="title.png" alt="title" /><br />
Обратите внимание: надпись УЖЕ составлена, а для редактирования нужно кликнуть на тайле в окне “Текст, код и прочий мусор” и редактировать тайл в правом нижнем окошке (кстати, оно тут намного больше, чем в TLP).<br />
А после окончания редактирования нужно будет сохранить файл, и уже в простом графическом редакторе скопировать изменённую графику в РОМ. Тут, разумеется, могут быть варианты: например в дампе графика может быть “наборной”. Скажем, верхняя часть из одного места CHR ROM’a, середина из другого, а низа может вообще не быть. Однако эта проблема легко преодолима визуальным поиском нужной части CHR ROM’a в оригинальном РОМ’е.<br />
Правда, в этом методе есть и свои минусы: редактировать графику потайлово не совсем удобно, однако Djinn Tile Mapper позволяет это делать только так.<br />
Кстати, данные о которых я говорил, содержатся не только в дампе FCEUxd, они просто обязанны быть в любом сэйв файле абсолютно любого эмулятора, только вот адреса нужных нам данных могут сильно варьироваться в зависимости от эмулятора.<br />
Есть, правда, совсем уж продвинутый и красивый способ: достать графику и тайловые карты в разные файлы, вручную сделать Photoshop’овскую палитру и воспользоваться программой Djinn’a Map Image. Получится обычный BMP файл, который можно отредактировать где угодно, хоть в том же Photoshop’е - будет обалденно красиво ^_^ Только потом надо будет вставлять карту обратно, для чего её надо будет сжимать обратно. Да и CHR может сильно поменяться по сравнению с оригиналом.</p><hr />
</div></body></html>